<!-- <html>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

  <body style="margin: 0px; overflow: hidden;">
    <a-scene embedded arjs>
        <a-marker type="pattern" url="./pattern-QRShadow.patt">
            <a-entity 
            position="0 0 0" 
            scale="1 1 1" 
            gltf-model="./kartrider_shadow_the_hedgehog.glb"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
        </a-entity>
    </a-marker>
    <a-entity camera></a-entity>
</a-scene>
</body>
</html> -->
<!-- Substituímos o marcador Hiro pelo marcador personalizado -->
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Video AR</title>
    <!-- Biblioteca Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Biblioteca JSARToolkit -->
    <script src="https://cdn.jsdelivr.net/gh/artoolkit/jsartoolkit5/artoolkit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/artoolkit/jsartoolkit5/artoolkit.api.js"></script>
    <!-- Extensões para integração com Three.js -->
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js/three.js/build/ar-threex.js"></script>
</head>
<body style="margin: 0; overflow: hidden; font-family: sans-serif;">
    <!-- Carrega o vídeo localmente -->
    <video id="video" autoplay loop muted playsinline style="display: none;">
        <source src="./Coringa (Joker) - Vídeo Motivacional Para Status whatsapp -.mp4" type="video/mp4">
        Seu navegador não suporta vídeos.
    </video>

    <script>
        let scene, camera, renderer, arToolkitContext, arToolkitSource, markerRoot, videoTexture;

        function init() {
            // Configuração da cena
            scene = new THREE.Scene();

            // Luz ambiente
            const light = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(light);

            // Configuração da câmera
            camera = new THREE.Camera();
            scene.add(camera);

            // Configuração do renderizador
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x000000, 0); // Fundo transparente
            document.body.appendChild(renderer.domElement);

            // Fonte de vídeo do AR
            arToolkitSource = new THREEx.ArToolkitSource({ sourceType: 'webcam' });

            // Redimensiona ao carregar ou ajustar janela
            arToolkitSource.init(() => onResize());
            window.addEventListener('resize', () => onResize());

            // Contexto do ARToolkit
            arToolkitContext = new THREEx.ArToolkitContext({
                cameraParametersUrl: 'https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js/three.js/examples/camera_para.dat',
                detectionMode: 'mono'
            });

            arToolkitContext.init(() => {
                camera.projectionMatrix.copy(arToolkitContext.getProjectionMatrix());
            });

            // Configuração do marcador
            markerRoot = new THREE.Group();
            scene.add(markerRoot);
            new THREEx.ArMarkerControls(arToolkitContext, markerRoot, {
                type: 'pattern',
                patternUrl: 'https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js/three.js/examples/marker-training/examples/pattern-files/pattern-hiro.patt'
            });

            // Adiciona o vídeo ao marcador
            const videoElement = document.getElementById('video');
            videoTexture = new THREE.VideoTexture(videoElement);
            const material = new THREE.MeshBasicMaterial({ map: videoTexture });
            const plane = new THREE.Mesh(new THREE.PlaneGeometry(2, 2), material);
            plane.rotation.x = -Math.PI / 2; // Ajusta a orientação
            markerRoot.add(plane);

            animate();
        }

        function onResize() {
            arToolkitSource.onResize();
            arToolkitSource.copySizeTo(renderer.domElement);
            if (arToolkitContext.arController) {
                arToolkitSource.copySizeTo(arToolkitContext.arController.canvas);
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            if (arToolkitSource.ready) {
                arToolkitContext.update(arToolkitSource.domElement);
            }
            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>
